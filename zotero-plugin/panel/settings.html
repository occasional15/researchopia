<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>研学港 Researchopia — 设置</title>
  <link rel="stylesheet" href="panel.css" />
  <style>
    body { padding: 12px; font: 13px/1.4 system-ui, sans-serif; }
    .row { margin-bottom: 10px; }
    label { display: block; margin-bottom: 4px; color: #495057; }
    input { width: 100%; padding: 6px 8px; border: 1px solid #ced4da; border-radius: 4px; }
    .actions { margin-top: 12px; display: flex; gap: 8px; }
    button { padding: 6px 10px; border: 1px solid #ced4da; border-radius: 4px; background: #fff; cursor: pointer; }
  </style>
  <script type="module">
    function getPref(key, fallback='') {
      try { return Zotero.Prefs.get(key, true) ?? fallback } catch { return fallback }
    }
    function setPref(key, value) {
      try { Zotero.Prefs.set(key, value, true) } catch {}
    }
    window.addEventListener('DOMContentLoaded', () => {
      const baseUrl = document.querySelector('#baseURL');
      const height = document.querySelector('#paneHeight');
      baseUrl.value = getPref('extensions.academic-rating.baseURL', 'https://www.researchopia.com');
      height.value = getPref('extensions.academic-rating.paneHeight', '100%');
      document.querySelector('#save').addEventListener('click', () => {
        setPref('extensions.academic-rating.baseURL', baseUrl.value.trim());
        setPref('extensions.academic-rating.paneHeight', height.value.trim());
        alert('设置已保存');
      });
      document.querySelector('#reset').addEventListener('click', () => {
        baseUrl.value = 'https://www.researchopia.com';
        height.value = '100%';
      });
    });
  </script>
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self';" />
</head>
<body>
  <h2>研学港 Researchopia — 设置</h2>
  <div class="row">
    <label for="baseURL">站点地址（baseURL）</label>
    <input id="baseURL" placeholder="https://www.researchopia.com" />
  </div>
  <div class="row">
    <label for="paneHeight">容器高度（如：100%、600px）</label>
    <input id="paneHeight" placeholder="100%" />
  </div>
  <div class="actions">
    <button id="save">保存</button>
    <button id="reset">恢复默认</button>
  </div>
</body>
</html>
