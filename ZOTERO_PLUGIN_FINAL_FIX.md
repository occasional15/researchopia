# 研学港 Zotero插件最终修复指南

## 🔍 问题分析

根据您的Debug Output，问题在于：
- 插件安装成功 ✅
- 但在启动时出现错误：`研学港: 启动错误: undefined` ❌
- 导致Item Pane没有显示

## 🛠️ 根本原因

问题在于bootstrap.js试图加载 `researchopia-simple-final.js`，但实际文件名是 `researchopia.js`。

## ✅ 已修复的问题

1. **文件名不匹配** - 已修复bootstrap.js中的文件路径
2. **创建了极简版** - 更简单的代码，更容易调试
3. **准备了两个版本** - 简化版和极简版

## 🚀 立即解决方案

### 方案1: 使用修复后的简化版（推荐）

**文件位置**: `zotero-plugin/final-build/v0.8.21.xpi`

**安装步骤**:
1. 在Zotero中卸载当前插件
2. 安装 `final-build/v0.8.21.xpi` 文件
3. 重启Zotero

### 方案2: 使用极简版（最稳定）

**文件位置**: `zotero-plugin/minimal-build/`

**安装步骤**:
1. 打开 `minimal-build` 文件夹
2. 选择所有文件，右键 → "发送到" → "压缩(zipped)文件夹"
3. 将ZIP文件重命名为 `researchopia-minimal.xpi`
4. 在Zotero中安装此文件

## 📋 详细安装步骤

### 步骤1: 卸载旧插件

1. 打开Zotero
2. 点击 "工具" → "插件"
3. 找到 "研学港 Researchopia" 插件
4. 点击 "禁用" 或 "卸载"

### 步骤2: 安装修复版插件

**选择以下任一方案**：

#### 方案A: 使用现有XPI文件
1. 在Zotero中点击 "工具" → "插件"
2. 点击右上角齿轮图标 ⚙️
3. 选择 "从文件安装插件..."
4. 选择 `zotero-plugin/final-build/v0.8.21.xpi`
5. 重启Zotero

#### 方案B: 创建极简版XPI
1. 打开 `zotero-plugin/minimal-build/` 文件夹
2. 选择所有文件和文件夹（Ctrl+A）
3. 右键 → "发送到" → "压缩(zipped)文件夹"
4. 将生成的ZIP文件重命名为 `researchopia-minimal.xpi`
5. 在Zotero中安装此文件

### 步骤3: 验证安装

1. **检查插件状态**:
   - 重新打开 "工具" → "插件"
   - 确认 "研学港 Researchopia" 插件已启用

2. **测试插件功能**:
   - 在Zotero中选择任意文献
   - 查看右侧面板是否显示 "研学港 Researchopia" 标签页
   - 检查插件界面是否正常显示

## 🔍 预期结果

安装成功后，您应该看到：

### 简化版界面
- ✅ 标题："研学港 Researchopia"
- ✅ 副标题："学术标注分享平台 - 简化版"
- ✅ 状态指示器：显示连接状态和端口
- ✅ 用户认证区域：登录/登出按钮
- ✅ 操作按钮：同步、分享、浏览、刷新
- ✅ 文献信息：DOI、标题等

### 极简版界面
- ✅ 标题："研学港 Researchopia"
- ✅ 副标题："学术标注分享平台 - 极简版"
- ✅ 插件状态：显示"插件已加载"
- ✅ 文献信息：显示标题和DOI状态
- ✅ 测试按钮：验证插件功能

## 🛠️ 故障排除

### 问题1: 插件仍然不显示

**可能原因**:
- 插件文件损坏
- Zotero版本不兼容
- 缓存问题

**解决方案**:
1. 完全卸载插件
2. 重启Zotero
3. 重新安装插件
4. 检查Zotero版本（需要7.0+）

### 问题2: 控制台仍有错误

**可能原因**:
- 文件加载失败
- 语法错误
- 权限问题

**解决方案**:
1. 查看具体错误信息
2. 使用极简版插件
3. 检查文件完整性

### 问题3: 界面显示异常

**可能原因**:
- 样式问题
- 脚本错误
- 兼容性问题

**解决方案**:
1. 使用极简版插件
2. 检查Zotero开发者工具
3. 重新安装插件

## 📊 调试信息

如果问题仍然存在，请提供：

1. **Zotero版本**: 帮助 → 关于Zotero
2. **操作系统**: Windows版本
3. **错误日志**: 控制台中的具体错误信息
4. **插件状态**: 是否在插件管理器中显示

## 🎯 下一步

插件正常显示后，我们可以：

1. **测试基础功能**: 验证插件界面和基本功能
2. **添加更多功能**: 逐步完善插件功能
3. **优化界面**: 改进用户体验
4. **集成服务器**: 连接研学港后端服务

---

**重要提示**: 请先使用极简版插件验证基础功能，确保插件能正常加载和显示。一旦基础功能正常，我们可以逐步添加完整功能。
