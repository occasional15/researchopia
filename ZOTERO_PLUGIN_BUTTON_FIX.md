# 研学港 Zotero插件按钮修复指南

## ✅ 问题已修复

根据您的反馈，插件面板已成功显示，但按钮无响应。我已经修复了以下问题：

### 🔧 修复内容

1. **按钮事件监听器修复**
   - 改进了按钮选择器逻辑
   - 使用更可靠的文本匹配方式
   - 确保所有按钮都能正确绑定事件

2. **按钮功能改进**
   - 添加了更好的用户反馈
   - 改进了错误处理
   - 增加了状态检查

3. **界面状态更新**
   - 刷新按钮现在会更新界面状态
   - 连接状态会实时更新
   - 按钮状态会根据认证状态变化

## 🚀 安装修复版插件

### 步骤1: 卸载当前插件

1. 打开Zotero
2. 点击 "工具" → "插件"
3. 找到 "研学港 Researchopia" 插件
4. 点击 "禁用" 或 "卸载"

### 步骤2: 安装修复版

1. 在Zotero中点击 "工具" → "插件"
2. 点击右上角齿轮图标 ⚙️
3. 选择 "从文件安装插件..."
4. 选择 `zotero-plugin/researchopia-fixed-v2.xpi` 文件
5. 重启Zotero

### 步骤3: 测试按钮功能

1. **选择任意文献**
2. **测试各个按钮**：
   - 🔄 **刷新按钮**: 应该显示"正在刷新状态..."然后"状态已刷新"
   - 🔄 **同步标注按钮**: 应该显示"请先登录以使用同步功能"
   - 📤 **分享标注按钮**: 应该显示"请先登录以使用分享功能"
   - 🌐 **浏览共享按钮**: 应该显示"此文献没有DOI，无法浏览"或打开浏览器

## 📋 预期结果

### 按钮响应测试

1. **刷新按钮** ✅
   - 点击后显示"正在刷新状态..."
   - 然后显示"状态已刷新"
   - 状态指示器可能会更新

2. **同步标注按钮** ✅
   - 点击后显示"请先登录以使用同步功能"
   - 按钮可能显示为禁用状态

3. **分享标注按钮** ✅
   - 点击后显示"请先登录以使用分享功能"
   - 按钮可能显示为禁用状态

4. **浏览共享按钮** ✅
   - 点击后显示"此文献没有DOI，无法浏览"
   - 或者打开浏览器（如果有DOI）

### 界面状态更新

- 状态指示器会根据连接状态更新颜色
- 端口信息会显示检测到的端口
- 按钮状态会根据认证状态变化

## 🛠️ 故障排除

### 问题1: 按钮仍然无响应

**可能原因**:
- 插件未正确更新
- 缓存问题

**解决方案**:
1. 完全卸载插件
2. 重启Zotero
3. 重新安装修复版插件

### 问题2: 按钮有响应但功能异常

**可能原因**:
- 服务器未运行
- 网络连接问题

**解决方案**:
1. 确保研学港服务器正在运行
2. 点击"刷新"按钮重新检测
3. 检查网络连接

### 问题3: 界面状态不更新

**可能原因**:
- 状态更新函数问题
- 界面元素选择器问题

**解决方案**:
1. 查看控制台错误信息
2. 重新安装插件
3. 检查文献选择

## 🎯 下一步

按钮功能正常后，我们可以：

1. **启动服务器**: 运行 `npm run dev:full` 启动研学港服务
2. **测试连接**: 点击"刷新"按钮检测服务器连接
3. **完善功能**: 逐步添加完整的同步、分享功能
4. **优化界面**: 改进用户体验

## 📞 技术支持

如果按照上述步骤操作后仍有问题，请：

1. **提供详细信息**:
   - 具体哪个按钮无响应
   - 控制台是否有错误信息
   - 插件版本信息

2. **查看日志**:
   - 打开Zotero开发者工具（F12）
   - 查看Console标签页的错误信息

3. **重新安装**:
   - 完全卸载插件
   - 重启Zotero
   - 重新安装修复版

---

**重要提示**: 请先测试按钮响应，确保基础功能正常。一旦按钮功能正常，我们就可以继续完善其他功能。
